% ******** Приклад оформлення документа за ДСТУ 3008-95 ********
% ******************** автор: Тавров Д. Ю. *********************

% зазначаємо стильовий файл, який будемо використовувати
\documentclass{../../dstu}
% починаємо верстку документа
\begin{document}

% створимо титульний аркуш
% за допомогою спеціальної команди
% \maketitlepage{params},
% де params --- це розділені комами пари "параметр={значення}"
\maketitlepage{
% StudentName --- прізвище, ініціали студента
	StudentName={Бубела Д. В.},
% StudentMale --- стать студента (true, якщо чоловік, false --- якщо жінка)
	StudentMale=true,
% StudentGroup --- група студента
	StudentGroup={КМ-82},
% Title --- назва
	Title={Звіт\\із лабораторної роботи №4\\із дисципліни \invcommas{Автоматизоване тестування програмного забезпечення}\\на тему\\Тестування веб-застосунку за допомогою Python та Selenium WebDriver},
% SupervisorDegree --- науковий ступінь, учене звання керівника роботи
% якщо наукового ступеня немає, можна відповідний рядочок пропустити
	SupervisorDegree={\textit{асистент}},
% SupervisorName --- прізвище, ініціали керівника роботи
	SupervisorName={\textit{Громова В. В.}}
}
% створюємо зміст
\tableofcontents

% створюємо Мету роботи
\goal
Ознайомитися з \invcommas{Selenium WebDriver}.
Протестувати локально веб-застосунок простої структури відповідно до специфікації.
Тестування здійснювати в python за допомогою модуля unittest з застосуванням \invcommas{Selenium WebDriver}

\textbf{Специфікація}

Веб-застосунок призначений для отримання коментарів-відповідей на запитання, складається з однієї веб-сторінки і має наступну функціональність:

\begin{enumerate}[{label={\arabic*.}}]
    \item Довільний користувач може переглянути питання, яке розташоване в лівій верхній частині сторінки, та існуючі коментарі до цього питання.
    \item Sign Up: новий користувач може зареєструватися, увівши свої значення в поля Display Name, Email, Password та натиснувши кнопку \textbf{Sign Up}. При виконання умови, що всі поля заповнені і значення Email –  унікальне серед всіх e-mail на backend, реєстрація буде виконана успішно,  користувач автоматично входить в свій обліковий запис, і на сторінці з’являється кнопка \textbf{Log Out}.
    \item Користувач може вийти зі свого облікового запису, натиснувши кнопку \textbf{Log Out}.
    \item \textbf{Log In}: зареєстрований користувач може увійти в свій обліковий запис. Для цього необхідно ввести правильні e-mail та пароль в поля Email та Password , після чого натиснути кнопку \textbf{Log In}.
    \item Користувач, що увійшов в свій обліковий запис, може додавати коментарі до питання. Для цього користувачу необхідно написати текст коментаря в спеціальному редакторі, що знаходиться на сторінці, та натиснути кнопку New comment.
    \item До натискання кнопки \textbf{New comment} користувач може форматувати текст коментаря за допомогою кнопок редактора – виділити коментар або його частину \textbf{жирним} (кнопка \textbf{B}), \textit{курсивом} (кнопка \textit{I}), \underline{підкресленим} (кнопка \underline{U})  або \st{закресленим} (кнопка \st{O}).
    \item Користувач, що увійшов в свій обліковий запис, може видаляти створений ним коментар, натиснувши кнопку \textbf{Remove}, розташовану справа від потрібного коментаря.
    \item За замовчуванням на сторінці присутні коментарі “Test comment 1”, “Test comment 2”, створені користувачами Alice A. та Bob B., які мають наступні Email та Password:
    alice\_2002@gmail.com,  `aaa`
    bob\_2001@gmail.com,  `bbb`.
    \item Для спрощення задачі веб-застосунок не зберігає дані постійно. При зупинці backend всі дані будуть втрачені. Тестові користувачі та коментарі створюються автоматично при кожному запуску backend. 
\end{enumerate}

\chapter{Постановка задачі}
\label{chap:condition}
Необхідні для встановлення пакети в пайтон: tornado, selenium. Selenium WebDriver відповідно до браузера встановлюється в систему.

\textbf{Завдання}

Створити тестовий модуль — скрипт на мові Python, який в автоматичному режимі запускає веб-сервер та виконує наступні дії:

\begin{enumerate}
 \item Перевіряє, що анонімний користувач бачить на сторінці:
    \begin{enumerate}
        \item Заголовок питання, який співпадає з очікуваним заголовком.
        \item Текст питання (переконатися, що блок під заголовком є непустим).
        \item Коментарі до питання, які існують за замовчуванням (переконатися, що співпадають тексти та відповідні автори коментарів).
        \item Кнопки Sign Up, Log In.
        \item Поля для введення Display Name, Email та Password та їх підписи.
    \end{enumerate}
  \item Перевіряє, що новий користувач може зареєструватись, увівши значення Display Name, Email та Password:
\begin{enumerate}
\item Протестувати, що у випадку успішної реєстрації користувач автоматично входить у свій обліковий запис, на сторінці з’являється його Display Name та кнопка Log Out.
\item Протестувати, що натискання на кнопку Log Out призводить до виходу користувача зі свого облікового запису
\item  Протестувати, що при неунікальному значенні Email на backend створення нового користувача не відбувається, веб-застосунок не переходить в стан зареєстрованого користувача. 

\end{enumerate}
\item Перевіряє, що зареєстрований користувач, увівши правильні значення Email та Password та натиснувши на кнопку Log In, входить до свого облікового запису. Протестувати, що при введенні некоректного Email або Password  — користувач не входить до свого облікового запису.
\item Перевіряє, що якщо користувач знаходиться у своєму обліковому запису, то на сторінці є Редактор для введення нового коментаря та кнопка New comment. Виконати JS script, що робить border елемента з id = “editor section” червоного кольору. Зробити скріншоти веб-сторінки засобами Selenium WebDriver.
\item Перевіряє, що користувач, який знаходиться у своєму обліковому запису, може ввести новий коментар: 
\begin{enumerate}
\item Після введення тексту коментаря та натискання на кнопку New comment створений коментар відображається у списку всіх коментарів.
\item Текст коментаря, відформатований в Редакторі за допомогою кнопок B, I, U, O відображається у коментарі так, як очікується.
\item Поруч зі створеним коментарем присутнє ім’я користувача Display Name та кнопка Remove.

\end{enumerate}
\item Перевіряє, що користувач, який знаходиться у своєму обліковому запису, може ввести ще один коментар: 
\begin{enumerate}
\item Переконатися, що вдалося створити ще один коментар.
\item Переконатися, що коментар знаходиться після попереднього коментаря, створеного даним користувачем.

\end{enumerate}
\item Перевіряє, що користувач, який знаходиться у своєму обліковому запису, може видалити створений ним коментар: 
\begin{enumerate}
\item Переконатися, що видаляється потрібний коментар.
\item Переконатися, що усі інші коментарі, створені даним користувачем та іншими користувачами, залишилися на місці.

\end{enumerate}

\item Перевіряє, що одночасно у своїх облікових записах можуть бути активними два різних користувача:
\begin{enumerate}
    \item Увійти в браузері driver1 в обліковий запис користувача user1 та створити коментар comment1.
    \item В автоматичному режимі запустити ще один браузер driver2, виконати Log In від імені користувача user2 та створити коментар comment2. Протестувати, що в браузері driver2 присутні обидва коментаря — comment1 та comment2.
    \item В браузері driver1 від імені користувача user1 додати коментар comment3. Протестувати, що в браузері driver1, присутні три коментаря — comment1, comment2 та comment3.
    \item В браузері driver2 видалити коментар comment2. Протестувати, що в браузері driver2 присутні два коментаря — comment1 та comment3.
    \item Закрити обидва браузера, після чого знову запустити браузер і протестувати, що анонімний користувач бачить два коментаря — comment1 та comment3.
\end{enumerate}


\end{enumerate}

\chapter{Основна частина}
\label{chap:main}
В обох завданнях уся робота здійснюється в python з бібліотекою для тестуваннь unittest.
Лабораторна робота проводиться в браузері \invcommas{Mozilla Firefox 83.0}. Для здійснення приймального тестування використовувався модуль Popen з бібліотеки subprocess. Він потрібен для створення нового процесу від запущеного скрипта, що забезпечував би роботу веб сервера, який тестується.

Метод setUp створює процес ``бекенду'' і ініціалізує веб-драйвер. Метод tearDown завершує роботу веб-драйвера та сервера, що тестується. Ці методи викликаються безпосередньо перед та після виконання кожного з тестів.

Під час тестування в консоль виводяться помилки сервера, але так має бути. Unittest перенаправляє всі вихідні потоки підпроцесу у вивід тої програми, яка запущеня для тестування.

Для коректного збереження скріншоту в завданні г) необхідно додати таймаут time.sleep(2).

% створюємо Висновки
\conclusions

Ми навчилися використовувати Selenium WebDriver для приймального тестування веб-додатків. У ході роботи було розроблено 8 тест-кейсів для повного покриття специфікації програми. Також попрактикувались в створенні автоматичних тестів з допомогою unittest та виклику окремих інструкцій до та після виконання окремих тестів. Переглянули способи використання конструкцій \_\_enter\_\_ та \_\_exit\_\_ що було необхідно для розуміння роботи викликів вебдрайверу.
	
% створюємо перелік посилань
\begin{thebibliography}
	\bibitem{subprocess} Python Software Foundation. subprocess — Subprocess management
[Електронний ресурс] / Python Software Foundation.. — 2020. — Режим доступу
до ресурсу: \url{https://docs.python.org/3/library/subprocess.html.}.
	\bibitem{seleniumref} \label{} Selenium IDE API Reference [Електронний ресурс]. – 2019. – Режим доступу до ресурсу: \url{https://www.selenium.dev/selenium-ide/docs/en/api/commands}.
	\bibitem{xpathdocs} MDN contributors. XSLT/XPath Reference [Електронний ресурс] / MDN contributors. – 2020. – Режим доступу до ресурсу: \url{https://developer.mozilla.org/en-US/docs/Web/XPath}.
	\bibitem{unittest} Python Software Foundation.unittest — Unit testing framework[Електронний ресурс] / Python Software Foundation.. — 2020. — Режим доступу до
ресурсу: \url{ https://docs.python.org/3/library/unittest.html}.
    \bibitem{tornado} FriendFeed. Structure of a Tornado web application [Електронний ресурс] / FriendFeed // 6.1.0. – 2019. – Режим доступу до ресурсу: \url{https://www.tornadoweb.org/en/stable/guide/structure.html}.
\end{thebibliography}

\append{Текст модулів, що реалізують автоматичне тестування}

\listing{test.py}{SRC/test.py}

\append{Скріншоти результатів виконання автотестів}
\begin{figure}[!htp]
	\centering
	\includegraphics[scale=0.85]{PNG/Test1.png}
	\caption{Скріншот тестування test\_1.py}
	\label{fig:Test1}
\end{figure}

\begin{figure}[!htp]
	\centering
	\includegraphics[scale=0.35]{PNG/comments_screenshot.png}
	\caption{Скріншот зроблений за допомогою Selenium WebDriver comments\_screenshot.png}
	\label{fig:screenshot}
\end{figure}

\append{Відповіді на контрольні запитання}
\begin{enumerate}[label=\arabic*)]
\item Що таке Selenium WebDriver? Яке його призначення?

Webdriver — це інструмент управління браузером за допомогою його API, з системи проддуктів Selenium, що використовується в зв'язці з мовами програмування.
\item Як запустити браузер за допомогою Python та Selenium WebDriver?

Потрібно ініціалізувати вебдрайвер та за його допомогою 
\item Як ввести текст в текстове поле за допомогою Selenium WebDriver?

Знайти через драйвер і відповідні його методи текстове поле, додати туди текст методом send\_keys або іншим доступним, влючно з наведенням курсору і імітування натискання клавіш клавіатури, викликом JavaScript.
\item Як за допомогою Python та Selenium WebDriver перевірити, що певний елемент відображається на екрані?

Спробувати його знайти на сторінці (метод find\_element) і перевірити чи пошук виявився успішним.
\item Як можна зачекати появу елемента на сторінці?

Можна використати метод WebDriverWait з selenium.webdriver.support.ui та expected\_conditions з elenium.webdriver.support наприклад element = WebDriverWait(driver, 10) .until( EC.presence\_of\_element\_located((By.ID, "myDynamicElement"))) або просто зачекати методами python наприклад time.sleep(10).
\item Як можна отримати текст веб-елемента? Як можна отримати атрибут веб-елемента?

Текста можна отримати за допомогою метода елемента (WebElement) --- text.

Атрибут можна отримати за допомогою метода елемента --- get\_attribute("attribute name")
\item Коли використовуються findElement() та findElements()?

Перший метод повертає елемент першого співпадіння з критерієм умови. Другий метод повертає всі елементи, що задовольняють критерій у вигляді списку з WebElement.
\item Як можна зробити скріншот за допомогою Python та Selenium WebDriver?

За допомогою методу вебдрайвера --- save\_screenshot.
\item Як і з якою метою можна виконати JavaScript код в браузері за допомогою Selenium WebDriver?

Можна використати метод драйвера execute\_script аргументом якого передати необхідний для виконання скрипт.
\item Наведіть переваги та недоліки Selenium WebDriver, які Ви помітили під час виконання лабораторної роботи?

Повна імітація роботи користувача за допомогою вбудованого API браузера має як переваги так і недоліки. Можливість використовувати її за допомогою мови програмування є великою перевагою, оскільки разом з викликом js забезпечує велику гнучкість в роботі. До недоліків можна віднести: Нестабільність роботи, особливо різна поведінка на різних браузерах з різними драйверами та різними рушіями виконання JavaScript, швидкість виконання.

\end{enumerate}


\end{document}
